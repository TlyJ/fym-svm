(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{482:function(t,e,a){var o=a(490);"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);(0,a(14).default)("d7f41806",o,!0,{sourceMap:!1})},484:function(t,e,a){var o=a(500);"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);(0,a(14).default)("64fe6236",o,!0,{sourceMap:!1})},485:function(t,e,a){"use strict";a.r(e);a(103),a(59);var o={name:"Tooltip",components:{Popper:a(144).default},props:{label:{type:String,required:!0},placement:{type:String,default:"bottom"},disabled:{type:Boolean,default:!1},offset:{type:Array,default:function(){return[0,5]}},appendToBody:{type:Boolean,default:!1},boundariesElement:{type:String,default:"viewport"},delay:{type:Number,default:500}},data:function(){return{show:!1,timeout:null}},methods:{onMouseEnter:function(){var t=this;this.timeout=setTimeout((function(){t.show=!0,t.appendToBody&&t.$nextTick((function(){t.append()}))}),this.delay)},onMouseLeave:function(){this.show?(this.appendToBody&&document.body.removeChild(this.$refs.label),this.show=!1):this.timeout&&clearTimeout(this.timeout)},append:function(){var t=this;document.body.appendChild(this.$refs.label),setTimeout((function(){t.$refs.popper&&t.$refs.popper.update()}),0)}}},r=(a(499),a(3)),i=Object(r.a)(o,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tooltip"},[a("div",{ref:"target",staticClass:"target",on:{mouseenter:t.onMouseEnter,mouseleave:t.onMouseLeave}},[t._t("default")],2),t._v(" "),a("transition",{attrs:{name:"fade"}},[t.show?a("Popper",{ref:"popper",attrs:{"transition-delay":300,"boundaries-element":t.boundariesElement,"target-element":t.$refs.target,placement:t.placement,offset:t.offset}},[a("span",{ref:"label",staticClass:"label",attrs:{disabled:t.disabled}},[t._v(t._s(t.label))])]):t._e()],1)],1)}),[],!1,null,"689f9f72",null);e.default=i.exports;installComponents(i,{Popper:a(144).default})},486:function(t,e,a){"use strict";a.r(e);a(103);var o={name:"Tag",props:{label:{type:[String,Number],default:""},color:{type:String,default:""},tag:{type:String,default:"span"},link:{type:String,default:void 0}}},r=(a(489),a(3)),i=Object(r.a)(o,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"tag select-none",attrs:{color:this.color}},[e(this.tag,{tag:"component",staticClass:"text",attrs:{href:this.link}},[this._v(this._s(this.label))])],1)}),[],!1,null,"3eb34f2a",null);e.default=i.exports},489:function(t,e,a){"use strict";var o=a(482);a.n(o).a},490:function(t,e,a){(e=a(13)(!1)).push([t.i,".tag[data-v-3eb34f2a]{display:inline-flex;border-radius:3px;height:20px;margin:4px}.text[data-v-3eb34f2a]{display:inline-block;outline:none;padding:2px 0;line-height:1;font-size:14px;margin:0 4px;max-width:180px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}[color=standard][data-v-3eb34f2a]{--bg-opacity:1;background-color:#f4f5f7;background-color:rgba(244,245,247,var(--bg-opacity));--text-opacity:1;color:#42526e;color:rgba(66,82,110,var(--text-opacity))}[color=green][data-v-3eb34f2a]{background-color:#57d9a3;background-color:rgba(87,217,163,var(--bg-opacity))}[color=blue][data-v-3eb34f2a],[color=green][data-v-3eb34f2a]{--bg-opacity:1;--text-opacity:1;color:#172b4d;color:rgba(23,43,77,var(--text-opacity))}[color=blue][data-v-3eb34f2a]{background-color:#4c9aff;background-color:rgba(76,154,255,var(--bg-opacity))}[color=red][data-v-3eb34f2a]{background-color:#ff8f73;background-color:rgba(255,143,115,var(--bg-opacity))}[color=purple][data-v-3eb34f2a],[color=red][data-v-3eb34f2a]{--bg-opacity:1;--text-opacity:1;color:#172b4d;color:rgba(23,43,77,var(--text-opacity))}[color=purple][data-v-3eb34f2a]{background-color:#998dd9;background-color:rgba(153,141,217,var(--bg-opacity))}[color=grey][data-v-3eb34f2a]{--bg-opacity:1;background-color:#42526e;background-color:rgba(66,82,110,var(--bg-opacity));--text-opacity:1;color:#f4f5f7;color:rgba(244,245,247,var(--text-opacity))}[color=grey-yellow][data-v-3eb34f2a]{--bg-opacity:1;background-color:#091e42;background-color:rgba(9,30,66,var(--bg-opacity));--text-opacity:1;color:#ffe380;color:rgba(255,227,128,var(--text-opacity))}[color=teal][data-v-3eb34f2a]{background-color:#00c7e6;background-color:rgba(0,199,230,var(--bg-opacity))}[color=teal][data-v-3eb34f2a],[color=yellow][data-v-3eb34f2a]{--bg-opacity:1;--text-opacity:1;color:#172b4d;color:rgba(23,43,77,var(--text-opacity))}[color=yellow][data-v-3eb34f2a]{background-color:#ffc400;background-color:rgba(255,196,0,var(--bg-opacity))}[color=green-light][data-v-3eb34f2a]{--bg-opacity:1;background-color:#e3fcef;background-color:rgba(227,252,239,var(--bg-opacity));--text-opacity:1;color:#064;color:rgba(0,102,68,var(--text-opacity))}[color=blue-light][data-v-3eb34f2a]{--bg-opacity:1;background-color:#deebff;background-color:rgba(222,235,255,var(--bg-opacity));--text-opacity:1;color:#0747a6;color:rgba(7,71,166,var(--text-opacity))}[color=red-light][data-v-3eb34f2a]{--bg-opacity:1;background-color:#ffebe6;background-color:rgba(255,235,230,var(--bg-opacity));--text-opacity:1;color:#bf2600;color:rgba(191,38,0,var(--text-opacity))}[color=purple-light][data-v-3eb34f2a]{--bg-opacity:1;background-color:#eae6ff;background-color:rgba(234,230,255,var(--bg-opacity));--text-opacity:1;color:#403294;color:rgba(64,50,148,var(--text-opacity))}[color=grey-light][data-v-3eb34f2a]{background-color:#ebecf0;background-color:rgba(235,236,240,var(--bg-opacity))}[color=grey-light][data-v-3eb34f2a],[color=teal-light][data-v-3eb34f2a]{--bg-opacity:1;--text-opacity:1;color:#42526e;color:rgba(66,82,110,var(--text-opacity))}[color=teal-light][data-v-3eb34f2a]{background-color:#b3f5ff;background-color:rgba(179,245,255,var(--bg-opacity))}[color=yellow-light][data-v-3eb34f2a]{--bg-opacity:1;background-color:#fff0b3;background-color:rgba(255,240,179,var(--bg-opacity));--text-opacity:1;color:#42526e;color:rgba(66,82,110,var(--text-opacity))}",""]),t.exports=e},491:function(t,e,a){"use strict";a.r(e);a(104),a(103),a(27),a(54);var o=function(){return Math.random().toString(36).substring(2)},r={name:"ContentLoader",props:{speed:{type:Number,default:2},preserveAspectRatio:{type:String,default:"none"},baseUrl:{type:String,default:""},primaryColor:{type:String,default:"var(--ui-01)"},secondaryColor:{type:String,default:"var(--ui-03)"},primaryOpacity:{type:Number,default:1},secondaryOpacity:{type:Number,default:1},uniqueKey:{type:String,default:""},animate:{type:Boolean,default:!0},viewBox:{type:String,default:void 0},width:{type:[String,Number],default:"300px"},height:{type:[String,Number],default:"20px"}},computed:{fill:function(){return{fill:"url(".concat(this.baseUrl,"#").concat(this.idGradient,")")}},idClip:function(){return this.uniqueKey?"".concat(this.uniqueKey,"-idClip"):o()},idGradient:function(){return this.uniqueKey?"".concat(this.uniqueKey,"-idGradient"):o()},clipPath:function(){return"url(".concat(this.baseUrl,"#").concat(this.idClip,")")}}},i=a(3),s=Object(i.a)(r,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("svg",{staticStyle:{display:"flex"},attrs:{viewBox:t.viewBox,width:t.width,height:t.height,version:"1.1",preserveAspectRatio:t.preserveAspectRatio}},[a("rect",{style:t.fill,attrs:{color:"yellow","clip-path":t.clipPath,x:"0",y:"0",width:"100%",height:"100%"}}),t._v(" "),a("defs",[a("clipPath",{attrs:{id:t.idClip}},[t.$slots.default?t._e():a("rect",{attrs:{x:"0",y:"0",rx:"3",ry:"3",width:"100%",height:"100%"}}),t._v(" "),t._t("default")],2),t._v(" "),a("linearGradient",{attrs:{id:t.idGradient}},[a("stop",{attrs:{offset:"0%","stop-color":t.primaryColor,"stop-opacity":t.primaryOpacity}},[t.animate?a("animate",{attrs:{attributeName:"offset",values:"-2; 1",dur:t.speed,repeatCount:"indefinite"}}):t._e()]),t._v(" "),a("stop",{attrs:{offset:"50%","stop-color":t.secondaryColor,"stop-opacity":t.secondaryOpacity}},[t.animate?a("animate",{attrs:{attributeName:"offset",values:"-1.5; 1.5",dur:t.speed,repeatCount:"indefinite"}}):t._e()]),t._v(" "),a("stop",{attrs:{offset:"100%","stop-color":t.primaryColor,"stop-opacity":t.primaryOpacity}},[t.animate?a("animate",{attrs:{attributeName:"offset",values:"-1; 2",dur:t.speed,repeatCount:"indefinite"}}):t._e()])],1)],1)])}),[],!1,null,null,null);e.default=s.exports},499:function(t,e,a){"use strict";var o=a(484);a.n(o).a},500:function(t,e,a){(e=a(13)(!1)).push([t.i,".tooltip[data-v-689f9f72]{display:inline-block}.label[data-v-689f9f72]{box-sizing:border-box;position:absolute;z-index:999999;padding:2px 10px;font-size:12px;font-weight:400;box-shadow:0 1px 2px 1px rgba(0,1,0,.2);white-space:nowrap;pointer-events:none;background-color:#172b4d;border-radius:3px;color:#fff}.fade-enter-active[data-v-689f9f72],.fade-leave-active[data-v-689f9f72]{transition:opacity .3s}.fade-enter[data-v-689f9f72],.fade-leave-to[data-v-689f9f72]{opacity:0}",""]),t.exports=e},550:function(t,e,a){"use strict";a.r(e);var o=a(491),r=function(){return Math.random()*(1-.7)+.7},i={name:"DashDetailsLoader",components:{ContentLoader:o.default},props:{isLoading:{type:Boolean,default:!1},primaryColor:{type:String,default:"var(--ui-01)"},secondaryColor:{type:String,default:"var(--ui-03)"}},data:function(){return{random:r}}},s=a(3),n=Object(s.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.isLoading?t._l(4,(function(e){return a("ContentLoader",{key:e,attrs:{"view-box":"0 0 840 72",height:"72px",width:"100%",primaryColor:t.primaryColor,secondaryColor:t.secondaryColor}},[a("rect",{attrs:{x:"0",y:"0",rx:"3",ry:"3",width:"178",height:"14"}}),t._v(" "),a("rect",{attrs:{x:"0",y:"22",rx:"3",ry:"3",width:217*t.random(),height:"20"}}),t._v(" "),a("rect",{attrs:{x:"420",y:"0",rx:"3",ry:"3",width:"228",height:"14"}}),t._v(" "),a("rect",{attrs:{x:"420",y:"22",rx:"3",ry:"3",width:157*t.random(),height:"20"}})])})):t._t("default")],2)}),[],!1,null,null,null);e.default=n.exports;installComponents(n,{ContentLoader:a(491).default})},844:function(t,e,a){"use strict";a.r(e);a(23),a(32),a(25),a(274),a(46),a(47),a(40),a(26),a(59);var o=a(16),r=a(48),i=a(798),s=a(801),n=a(694);function l(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,o)}return a}var c={layout:"dashboard",data:function(){return{isLoading:!0,isSubmitting:!1,items:[]}},head:function(){return{title:"任务 · Hamibot"}},computed:function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?l(Object(a),!0).forEach((function(e){Object(o.a)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}({},Object(r.b)("socket",["isJoined"])),watch:{isJoined:function(t,e){t&&this.init()}},beforeMount:function(){var t=this;this.$socket.on("task:list:success",(function(e){var a=e.items;t.items=a,t.isLoading=!1})),this.$socket.on("task:list:fail",(function(e){var a=e.message;t.$toast.error(a||"未知错误",{duration:15e3})})),this.$socket.on("task:remove:success",(function(e){for(var a=e._id,o=t.items,r=0;r<o.length;r++){if(o[r]._id===a){o.splice(r,1);break}}t.$toast.success("任务删除成功"),t.isSubmitting=!1})),this.$socket.on("task:remove:fail",(function(e){var a=e.message;t.$toast.error(a||"未知错误"),setTimeout((function(){return t.isSubmitting=!1}),3e3)}))},mounted:function(){this.isJoined&&this.init()},beforeDestroy:function(){this.$socket.off("task:list:success"),this.$socket.off("task:list:fail"),this.$socket.off("task:remove:success"),this.$socket.off("task:remove:fail")},methods:{format:function(t){return Object(i.a)(new Date(t),"yyyy-MM-dd HH:mm")},distance:function(t){return Object(s.a)(new Date(t),{locale:n.a,includeSeconds:!0})},isExpired:function(t){return new Date(t)<new Date},init:function(){this.isLoading&&this.$socket.emit("b:task:list")},remove:function(t){this.isSubmitting||(this.isSubmitting=!0,this.$socket.emit("b:task:remove",{_id:t}))}}},d=a(3),u=Object(d.a)(c,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("main",{staticClass:"h-full mb-12"},[a("header",{staticClass:"mt-12 border-b border-ui-03"},[a("div",{staticClass:"container mx-auto px-4 sm:px-0"},[a("div",{staticClass:"mb-12"},[a("h1",{staticClass:"text-3xl"},[t._v("\n          任务\n          "),a("Tag",{attrs:{label:"预览版",color:"purple-light"}})],1),t._v(" "),a("p",[t._v("按计划执行脚本")])]),t._v(" "),a("div",{staticClass:"mb-6 flex justify-end"},[a("div",{staticClass:"flex items-center -mx-1 sm:-mx-2"},[a("nuxt-link",{staticClass:"mx-1 sm:mx-2",attrs:{to:"/dashboard/tasks/create"}},[a("Button",{attrs:{appearance:"primary"}},[t._v("创建任务")])],1)],1)])])]),t._v(" "),a("main",{staticClass:"container mx-auto flex flex-col sm:flex-row mt-6 pb-12 sm:pb-24 px-4 sm:px-0"},[a("div",{staticClass:"w-full sm:w-8/12"},[a("h2",{staticClass:"text-xl mb-4"},[t._v("任务")]),t._v(" "),a("DashDetailsLoader",{attrs:{"is-loading":!t.isJoined||t.isLoading}},[t.items.length?a("div",t._l(t.items,(function(e,o){return a("div",{key:o,staticClass:"border border-ui-03 rounded flex flex-col mb-4 sm:mb-6"},[a("main",{staticClass:"flex items-center justify-between"},[a("div",{staticClass:"flex flex-col px-4 py-3 sm:px-5 sm:py-4 overflow-hidden"},[a("div",{staticClass:"inline-flex items-center"},[a("h2",{staticClass:"font-medium md:text-lg truncate"},[t._v("\n                    "+t._s(e.name)+"\n                  ")]),t._v(" "),e.enabled?t._e():a("span",{staticClass:"ml-1"},[a("Tag",{attrs:{label:"未启用",color:"grey"}})],1)]),t._v(" "),a("p",{staticClass:"sm:mt-1 text-text-02 text-sm truncate"},[t._v("\n                  "+t._s(e.description)+"\n                ")])]),t._v(" "),a("div",{staticClass:"px-2 py-1 sm:px-4 sm:py-2 flex-shrink-0"},[a("Dropdown",{staticClass:"text-left",attrs:{label:"管理"}},[a("DropdownItem",[a("span",{staticClass:"text-text-03"},[t._v("暂不支持编辑")])]),t._v(" "),a("DropdownItem",{on:{click:function(a){return t.remove(e._id)}}},[a("span",{staticClass:"text-support-01"},[t._v("删除")])])],1)],1)]),t._v(" "),a("footer",{staticClass:"border-t bg-ui-01 rounded-bl rounded-br w-full flex flex-col"},t._l(e.triggers,(function(e,o){return a("div",{key:"trig"+o,staticClass:"flex flex-col px-4 py-1 sm:px-5 sm:py-2"},[e.nextRunAt?a("div",{staticClass:"inline-flex items-center"},[a("svg",{staticClass:"fill-current h-5 min-w-5",attrs:{viewBox:"0 0 24 24"}},[a("path",{attrs:{d:"M12 2c5.523 0 10 4.478 10 10s-4.477 10-10 10S2 17.522 2 12 6.477 2 12 2zm0 1.667c-4.595 0-8.333 3.738-8.333 8.333 0 4.595 3.738 8.333 8.333 8.333 4.595 0 8.333-3.738 8.333-8.333 0-4.595-3.738-8.333-8.333-8.333zM11.25 6a.75.75 0 0 1 .743.648L12 6.75V12h3.25a.75.75 0 0 1 .102 1.493l-.102.007h-4a.75.75 0 0 1-.743-.648l-.007-.102v-6a.75.75 0 0 1 .75-.75z"}})]),t._v(" "),a("Tooltip",{attrs:{placement:"bottom",label:"下次运行时间"}},[a("span",{staticClass:"ml-1"},[t._v("\n                      "+t._s(t.format(e.nextRunAt))+"\n                    ")]),t._v(" "),t.isExpired(e.nextRunAt)?a("Tag",{attrs:{label:"已失效",color:"yellow-light"}}):a("span",{staticClass:"text-text-03 text-sm"},[t._v("\n                      ("+t._s(t.distance(e.nextRunAt))+")\n                    ")])],1)],1):t._e()])})),0)])})),0):a("div",{staticClass:"flex flex-col items-center justify-center my-24"},[a("span",{staticClass:"text-text-02"},[t._v("还没有添加任何任务")]),t._v(" "),a("div",{staticClass:"mt-8"},[a("nuxt-link",{attrs:{to:"/dashboard/tasks/create"}},[a("Button",{attrs:{appearance:"primary",spacing:"large"}},[a("span",{staticClass:"px-4"},[t._v("创建任务")])])],1)],1)])])],1),t._v(" "),t._m(0)])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"w-full sm:w-4/12 ml-0 sm:ml-12 mt-12 sm:mt-0"},[e("h2",{staticClass:"text-xl mb-4"},[this._v("日志")])])}],!1,null,null,null);e.default=u.exports;installComponents(u,{Tag:a(486).default,Button:a(33).default,Header:a(180).default,DropdownItem:a(270).default,Dropdown:a(269).default,Tooltip:a(485).default,Footer:a(181).default,DashDetailsLoader:a(550).default})}}]);